<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mastermind with Kivy-GUI &mdash; Python Workshop 2016Q2 1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Python Workshop 2016Q2 1 documentation" href="../index.html" />
    <link rel="up" title="PYWS - Overview" href="workshop.html" />
    <link rel="next" title="OOTS - Out-of-the-Shell" href="oots.html" />
    <link rel="prev" title="PYWS - Something to Meditate" href="day-05-23.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="oots.html" title="OOTS - Out-of-the-Shell"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="day-05-23.html" title="PYWS - Something to Meditate"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python Workshop 2016Q2 1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="workshop.html" accesskey="U">PYWS - Overview</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Mastermind with Kivy-GUI</a><ul>
<li><a class="reference internal" href="#a-real-brain-teaser-the-mastermind-game">A real brain teaser: the Mastermind game</a></li>
<li><a class="reference internal" href="#introduction-to-the-kivy-basicgui-package">Introduction to the Kivy BasicGui package</a><ul>
<li><a class="reference internal" href="#get-a-monospaced-font">Get a monospaced font</a></li>
<li><a class="reference internal" href="#make-use-of-kivy-use-a-prepared-kivy-app">Make use of Kivy - use a prepared Kivy App</a></li>
<li><a class="reference internal" href="#a-few-words-about-callback-functions">A few words about <em>callback functions</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-mastermind-game">The Mastermind Game</a></li>
<li><a class="reference internal" href="#about-kivy">About Kivy</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="day-05-23.html"
                        title="previous chapter">PYWS - Something to Meditate</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="oots.html"
                        title="next chapter">OOTS - Out-of-the-Shell</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/workshop/day-05-30.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mastermind-with-kivy-gui">
<h1>Mastermind with Kivy-GUI<a class="headerlink" href="#mastermind-with-kivy-gui" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><em>Day six - May, 30</em></div></blockquote>
<div class="section" id="a-real-brain-teaser-the-mastermind-game">
<h2>A real brain teaser: the Mastermind game<a class="headerlink" href="#a-real-brain-teaser-the-mastermind-game" title="Permalink to this headline">¶</a></h2>
<p>The RPS game may be fun if humans play it, but RPS against the computer is boring. At least it is a nice programming task for beginners, introducing some of the basic programming concepts.</p>
<p>The Mastermind game is a bit more demanding, both for the programming and the game play. Additionaly we will use a graphical user interface, for which we will use a small Kivy application. The Mastermind game is still really &#8220;command line&#8221;, but having a GUI with two windows makes it possible to create a nice user interface. The Kivy GUI is provided as prepared package, which we might just import to any &#8220;command line&#8221; style program.</p>
</div>
<div class="section" id="introduction-to-the-kivy-basicgui-package">
<h2>Introduction to the Kivy BasicGui package<a class="headerlink" href="#introduction-to-the-kivy-basicgui-package" title="Permalink to this headline">¶</a></h2>
<p>The BasicGui Package requires a monospaced font. In a <em>monospaced</em> font all character have the same width, as opposed to a <em>proportional</em> font, where letters like <code class="docutils literal"><span class="pre">M</span></code> or <code class="docutils literal"><span class="pre">W</span></code> are wider than <code class="docutils literal"><span class="pre">i</span></code> or <code class="docutils literal"><span class="pre">l</span></code>, Kivy does not come with a preinstalled monospaced font, but the Kivy installation has a folder, where additional fonts can be installed. In out last session we found out, that not everyone has access to a specific monospaced font, like the <code class="docutils literal"><span class="pre">Consola</span></code>.</p>
<div class="section" id="get-a-monospaced-font">
<h3>Get a monospaced font<a class="headerlink" href="#get-a-monospaced-font" title="Permalink to this headline">¶</a></h3>
<p>To get over this problem, there is a new python script: <code class="docutils literal"><span class="pre">monolith.py</span></code>, which installs a font named <code class="docutils literal"><span class="pre">Monolith</span></code> into the Kivy Font folder. The script can be found in the <code class="docutils literal"><span class="pre">projects\kivy_basicgui\fontpack\</span></code> folder of our Github repository. It simply should be executed to place the four <code class="docutils literal"><span class="pre">monolith*.ttf</span></code> files into the Kivy Folder. The <code class="docutils literal"><span class="pre">monolith.py</span></code> script is actually generated by another script in the same folder: <code class="docutils literal"><span class="pre">packmono.py</span></code>. The code includes several Python packages and is not intended as something easy to understand. But it shows again, how little Python code is necessary to get amazing results.</p>
</div>
<div class="section" id="make-use-of-kivy-use-a-prepared-kivy-app">
<h3>Make use of Kivy - use a prepared Kivy App<a class="headerlink" href="#make-use-of-kivy-use-a-prepared-kivy-app" title="Permalink to this headline">¶</a></h3>
<p>The Kivy basicgui module requires the font, which was installed in the previous step. The <code class="docutils literal"><span class="pre">basicgui.py</span></code> module is set up to be imported,  but it can also run by itself.  So just start the <code class="docutils literal"><span class="pre">basicgui.py</span></code> to see a <em>gui window</em>, which has no internal functionality, but shows, what we will get.</p>
<a class="reference internal image-reference" href="../_images/kivy_basicgui.png"><img alt="../_images/kivy_basicgui.png" class="align-center" src="../_images/kivy_basicgui.png" style="width: 454.29999999999995px; height: 290.5px;" /></a>
<p>To use the Kivy basicgui module for our own program, there are a number of steps to follow. First import the <code class="docutils literal"><span class="pre">basicgui</span></code> module, which should be in the same folder as our own module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">basicgui</span> <span class="kn">as</span> <span class="nn">gui</span>
</pre></div>
</div>
<p>The name <code class="docutils literal"><span class="pre">gui</span></code> can be used in our code as a shortcut for <code class="docutils literal"><span class="pre">basicgui</span></code>. What else could be in our local folder is a small image file (the name is <code class="docutils literal"><span class="pre">user_ico.png</span></code>), which is used as a program icon.</p>
<p>As we will see soon, we need a place to store some global variables. The recommendation is to use a global class G():</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">G</span><span class="p">():</span>
    <span class="nb">round</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># a counter - just an example, more variables can be added</span>
</pre></div>
</div>
<p>The program code should always start with a <code class="docutils literal"><span class="pre">main()</span></code> function. Here we just set up the interface between our program and the <code class="docutils literal"><span class="pre">basicgui</span></code> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Add you own Title here&quot;</span><span class="p">,</span>
                    <span class="n">cmdhdl</span><span class="o">=</span><span class="n">command_handler</span><span class="p">,</span>
                    <span class="n">inithdl</span><span class="o">=</span><span class="n">init_handler</span><span class="p">))</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>There is a call to the <code class="docutils literal"><span class="pre">config</span></code> function of the <code class="docutils literal"><span class="pre">basicgui</span></code> module. The config takes a dictionary as an argument. The keys of that dictionary are defined as:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">title</span></code></td>
<td>a string, which will appear as the title label of the gui window</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">cmdhdl</span></code></td>
<td>a local function, which will be called later, whenever the user enters some text</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">inithdl</span></code></td>
<td>a local function, which will be called only once after the gui is ready.
This allows the user to do some initialization and write some <em>welcome</em> message.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The next statement <code class="docutils literal"><span class="pre">gui.start()</span></code> starts the user interface. Its important to understand, that by starting the gui, our own program gives up control. The <code class="docutils literal"><span class="pre">start()</span></code> function will only come back, when the whole app has ended.</p>
<p>This is when the two local functions come into play. These functions are <em>callback</em> functions. Our programs hands over the functions to some gui configuration. Then, later, the gui will call these functions. The functions run in our local environment (better: <em>context</em>), but they are initiated by the gui. A callback function must return soon. It can not perform long running tasks, because while the callback is running, the gui is blocked, it appears to be frozen.</p>
<p>The first of the callbacks has to be defined like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">init_handler</span><span class="p">():</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">put_console</span><span class="p">(</span><span class="s">&#39;~clr~&#39;</span><span class="p">)</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="s">&#39;~clr~&#39;</span><span class="p">)</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span><span class="s">&#39;First message&#39;</span><span class="p">)</span>
    <span class="c"># do some more initialization work here</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">init_handler()</span></code> is called without any argument. It shows the use of two more functions from the Kivy gui. There are two functions: <code class="docutils literal"><span class="pre">put_console()</span></code> and <code class="docutils literal"><span class="pre">put_message()</span></code>, which take one parameter, which is a piece of text, which is appended to the gui window. Multiline text (text containing newlines) is allowed.
There is one special string: <code class="docutils literal"><span class="pre">'~clr~'</span></code> which triggers a delete of entire window text.</p>
<p>The other callback function is:</p>
<div class="highlight-python"><div class="highlight"><pre>def command_handler(text):
    # process the user input, which appears as the text argument
</pre></div>
</div>
<p>This function gets an argument, which is the line of text entered by the user. So this function is called every time, when the user hits the [enter] key. The text is not edited in any form with one exception: When the text <code class="docutils literal"><span class="pre">exit</span></code> is entered, the application is terminated by the gui.</p>
<p>To terminate the application there is another way: our code may call the function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gui</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>which also ends the gui.</p>
</div>
<div class="section" id="a-few-words-about-callback-functions">
<h3>A few words about <em>callback functions</em><a class="headerlink" href="#a-few-words-about-callback-functions" title="Permalink to this headline">¶</a></h3>
<p>A callback function is defined locally and handed over to some function or program. When a function is to be used as a parameter or a return value, its important to use the function name without the parenthesis (<code class="docutils literal"><span class="pre">func</span></code> not <code class="docutils literal"><span class="pre">func()</span></code>). If we use the <code class="docutils literal"><span class="pre">()</span></code>, the we actualy call the function, and what is given to the <em>other</em> side is the return value of that function.</p>
<p>The <em>other</em> side (in our case: some code inside the gui module) saves the function (we can think of it as a pointer to some code) and <em>calls</em> it, where it is appropriate. We must be aware, that our local function is called from outside, and must return again. It runs in the local <em>scope</em> and if it needs to access and remember some variables, these must be somewhere in this <em>local scope</em>. This is, where our global class <code class="docutils literal"><span class="pre">G</span></code> comes in handy. Here we can store everything, which we need to remember between separate calls of our callback function.</p>
<p>The above explanations should already be sufficient, to approach a solution for our next project. There is however an example program, which uses the Kivy gui, and which can be used as a reference. This is the <code class="docutils literal"><span class="pre">rps4kivy.py</span></code>, which can be found in the kivy-basicgui folder.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-mastermind-game">
<h2>The Mastermind Game<a class="headerlink" href="#the-mastermind-game" title="Permalink to this headline">¶</a></h2>
<p>The game of Mastermind is about guessing numbers. Its however not like RPS, where every guess is completely independent from the previous. With Mastermind we get get intermediate results and we can refine our guess over a number of rounds. The goal of the game is to need as few rounds as possible.</p>
<p>The rules are simple:</p>
<blockquote>
<div><ul class="simple">
<li>The program gives us a hidden sequence of 4 digits, each in the range of 1 to 6.</li>
<li>Our guess is always 4 digits long</li>
<li>For each guess the program creates a response, giving a string of <code class="docutils literal"><span class="pre">+</span></code> and <code class="docutils literal"><span class="pre">-</span></code></li>
<li>For each correct digit on the right position there is one <code class="docutils literal"><span class="pre">+</span></code></li>
<li>For other correct digits there is one <code class="docutils literal"><span class="pre">-</span></code></li>
<li>When we get 4 <code class="docutils literal"><span class="pre">+</span></code>, our guess was finally correct</li>
</ul>
</div></blockquote>
<p>Below is a sample game. The output of the program should be like this:</p>
<div class="highlight-python"><div class="highlight"><pre>  1.  1122  &gt;  +
  2.  3344  &gt;  +
  3.  5566  &gt;  --
  4.  1255  &gt;  +-
  5.  1536  &gt;  ---
  6.  6612  &gt;  +-
  7.  5164  &gt;  +---
  8.  1654  &gt;  ----
  9.  6145  &gt;  ++++
===================
</pre></div>
</div>
<p>In this game the correct number was guessed with 9 rounds.</p>
<p>In the two window gui, the right window displays a monospaced font, which works fine for displaying data in columns. So the left window is better for explanations and for interaction with the user. Reserve the right window for data output.</p>
</div>
<hr class="docutils" />
<div class="section" id="about-kivy">
<h2>About Kivy<a class="headerlink" href="#about-kivy" title="Permalink to this headline">¶</a></h2>
<p>The Kivy framework is a package, which allows to create graphical applications in python. The installation may a bit tricky, but its worth the effort. It is not too easy to use Kivy and it would go far beyond the time we have available for the workshop. But it looks like an interesting development. The most interesting feature is the cross-platform availability. At least its claimed, that a kivy app can be run even on iOS, Android and Raspberry operating systems. Being able to write an Android app seems cool enough to give the thing a try. (I did not try to <em>android</em>, yet)</p>
<p>It has to be said, that Kivy has its own philosophy, about how code should behave. Usually importing a module should just give us access to elements (functions, classes, ...) inside that module. Kivy is different, as it already starts a lot of activities on the process of importing the modules. It can be observed, that the import alone already produces some output. <strong>Kivy is not very pythonic</strong>.</p>
<p>If we use the basicgui module and configure everything, but forget to finally start the application, we get a kivy window, which appears to be frozen and we get no hint about what is going wrong. No error message, just an empty window. This is at least confusing. But now we know to take care of this and understand the meaning of a frozen window: <em>Ladies, start you app!</em> :-)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="oots.html" title="OOTS - Out-of-the-Shell"
             >next</a> |</li>
        <li class="right" >
          <a href="day-05-23.html" title="PYWS - Something to Meditate"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python Workshop 2016Q2 1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="workshop.html" >PYWS - Overview</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Hans Boden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>